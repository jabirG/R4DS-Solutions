{
  "hash": "3e4366385f0ce8ec164b489e9f9de1a8",
  "result": {
    "markdown": "---\ntitle: \"Chapter 12 Exploratory data analysis\"\nformat: html\neditor: visual\n---\n\n\n# Notes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.3     ✔ forcats 1.0.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggbeeswarm)\n```\n:::\n\n\nHeatmaply package and seriation package:\n\nIf the categorical variables are unordered, you might want to use the seriation package to simultaneously reorder the rows and columns in order to more clearly reveal interesting patterns. For larger plots, you might want to try the heatmaply package, which creates interactive plots.\n\nAnother approach for exploring the relationship between these variables is computing the counts with dplyr:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds |> \n  count(color, cut)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 35 × 3\n   color cut           n\n   <ord> <ord>     <int>\n 1 D     Fair        163\n 2 D     Good        662\n 3 D     Very Good  1513\n 4 D     Premium    1603\n 5 D     Ideal      2834\n 6 E     Fair        224\n 7 E     Good        933\n 8 E     Very Good  2400\n 9 E     Premium    2337\n10 E     Ideal      3903\n# … with 25 more rows\n```\n:::\n\n```{.r .cell-code}\n#> # A tibble: 35 × 3\n#>   color cut           n\n#>   <ord> <ord>     <int>\n#> 1 D     Fair        163\n#> 2 D     Good        662\n#> 3 D     Very Good  1513\n#> 4 D     Premium    1603\n#> 5 D     Ideal      2834\n#> 6 E     Fair        224\n#> # … with 29 more rows\n```\n:::\n\n\nThen visualize with [`geom_tile()`](https://ggplot2.tidyverse.org/reference/geom_tile.html) and the fill aesthetic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds |> \n  count(color, cut) |>  \n  ggplot(aes(x = color, y = cut)) +\n  geom_tile(aes(fill = n))\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nTo visualize the covariation between categorical variables, you'll need to count the number of observations for each combination of levels of these categorical variables. One way to do that is to rely on the built-in `geom_count()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = cut, y = color)) +\n  geom_count()\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nInstead, we recommend replacing the unusual values with missing values. The easiest way to do this is to use [`mutate()`](https://dplyr.tidyverse.org/reference/mutate.html) to replace the variable with a modified copy. You can use the [`if_else()`](https://dplyr.tidyverse.org/reference/if_else.html) function to replace unusual values with `NA`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds |> \n  mutate(y = if_else(y < 3 | y > 20, NA, y))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 53,940 × 10\n   carat cut       color clarity depth table price     x     y     z\n   <dbl> <ord>     <ord> <ord>   <dbl> <dbl> <int> <dbl> <dbl> <dbl>\n 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43\n 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31\n 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31\n 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63\n 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75\n 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48\n 7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47\n 8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53\n 9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49\n10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39\n# … with 53,930 more rows\n```\n:::\n:::\n\n\ncoord_cartesian() zoom into y\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = y)) + \n  geom_histogram(binwidth = 0.5) +\n  coord_cartesian(ylim = c(0, 50))\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# Questions\n\n# Solutions\n\n## Exercise 12.3.3\n\n1.Explore the distribution of each of the `x`, `y`, and `z` variables in `diamonds`. What do you learn? Think about a diamond and how you might decide which dimension is the length, width, and depth.\n\nlook up help ?diamonds\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n\nggplot(diamonds, aes(x = x , y = y)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nx is the length, y is the width, z is the depth\n\n2.Explore the distribution of `price`. Do you discover anything unusual or surprising? (Hint: Carefully think about the `binwidth` and make sure you try a wide range of values.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = price)) + geom_histogram(binwidth = 2000)\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n3.How many diamonds are 0.99 carat? How many are 1 carat? What do you think is the cause of the difference?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = carat)) + geom_histogram(binwidth = .1)\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n4.Compare and contrast [`coord_cartesian()`](https://ggplot2.tidyverse.org/reference/coord_cartesian.html) vs. [`xlim()`](https://ggplot2.tidyverse.org/reference/lims.html) or [`ylim()`](https://ggplot2.tidyverse.org/reference/lims.html) when zooming in on a histogram. What happens if you leave `binwidth` unset? What happens if you try and zoom so only half a bar shows?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = carat)) + geom_histogram(binwidth = .1) +\n  coord_cartesian(xlim = c(0,50))\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = carat)) + geom_histogram(binwidth = .1) + \n  coord_cartesian(ylim = c(0,50))\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n\n\nso it looks like when you use the xlim it zooms out but when you use the ylim it zooms in\n\n## Exercise 12.4.1\n\n1.What happens to missing values in a histogram? What happens to missing values in a bar chart? Why is there a difference in how missing values are handled in histograms and bar charts?\n\nthe missing values are removed with a warning\n\n2.What does `na.rm = TRUE` do in [`mean()`](https://rdrr.io/r/base/mean.html) and [`sum()`](https://rdrr.io/r/base/sum.html)?\n\nfor mean it determines whether na's should be removed or not and for sum should na values be removed and certain other values\n\n## Exercise 12.5.1.1\n\n1.Use what you've learned to improve the visualization of the departure times of cancelled vs. non-cancelled flights.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncanceled_flights <- nycflights13::flights |> \n  mutate(\n    cancelled = is.na(dep_time),\n    sched_hour = sched_dep_time %/% 100,\n    sched_min = sched_dep_time %% 100,\n    sched_dep_time = sched_hour + (sched_min / 60)\n  ) \n\nggplot(canceled_flights,aes(x = cancelled)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n2.What variable in the diamonds dataset is most important for predicting the price of a diamond? How is that variable correlated with cut? Why does the combination of those two relationships lead to lower quality diamonds being more expensive?\n\ni would say maybe clarity or just straight up price, i think because the lower quality diamonds correspond to people buying them who don't really know about diamonds or don't care about the quality,theres alot more lower quality diamonds than higher quality\n\n?diamonds\n\n3.Instead of exchanging the x and y variables, add [`coord_flip()`](https://ggplot2.tidyverse.org/reference/coord_flip.html) as a new layer to the vertical boxplot to create a horizontal one. How does this compare to using exchanging the variables?\n\nit switching the x and y its alot faster\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = hwy, y = fct_reorder(class, hwy, median))) +\n  geom_boxplot() + coord_flip()\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n4.One problem with boxplots is that they were developed in an era of much smaller datasets and tend to display a prohibitively large number of \"outlying values\". One approach to remedy this problem is the letter value plot. Install the lvplot package, and try using `geom_lv()` to display the distribution of price vs. cut. What do you learn? How do you interpret the plots?\n\nmy version of r can't get this\n\n5.Compare and contrast [`geom_violin()`](https://ggplot2.tidyverse.org/reference/geom_violin.html) with a faceted [`geom_histogram()`](https://ggplot2.tidyverse.org/reference/geom_histogram.html), or a colored [`geom_freqpoly()`](https://ggplot2.tidyverse.org/reference/geom_histogram.html). What are the pros and cons of each method?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds,aes(x = cut, y = price)) +\n  geom_violin()  \n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n6.If you have a small dataset, it's sometimes useful to use [`geom_jitter()`](https://ggplot2.tidyverse.org/reference/geom_jitter.html) to see the relationship between a continuous and categorical variable. The ggbeeswarm package provides a number of methods similar to [`geom_jitter()`](https://ggplot2.tidyverse.org/reference/geom_jitter.html). List them and briefly describe what each one does\n\nso geom_beeswarm makes it so you have more control over overplotting datasets, while geom_jitter to me seems like just a default that you can use on the go but if you do want more customization ggbeeswarm is better for handling overplotting\n\n## Exercise 12.5.2.1\n\n1.How could you rescale the count dataset above to more clearly show the distribution of cut within color, or color within cut?\n\ni can use this code from earlier that shows exactly that\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = cut, y = color)) +\n  geom_count()\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n2.How does the segmented bar chart change if color is mapped to the `x` aesthetic and `cut` is mapped to the `fill` aesthetic? Calculate the counts that fall into each of the segments.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds,aes( x = color, fill = cut)) +\n  geom_bar(position = \"fill\")\n```\n\n::: {.cell-output-display}\n![](chapter-12_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n3.Use [`geom_tile()`](https://ggplot2.tidyverse.org/reference/geom_tile.html) together with dplyr to explore how average flight delays vary by destination and month of year. What makes the plot difficult to read? How could you improve it?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(nycflights13::flights)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 336,776\nColumns: 19\n$ year           <int> 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2…\n$ month          <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ day            <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ dep_time       <int> 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 558, …\n$ sched_dep_time <int> 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 600, …\n$ dep_delay      <dbl> 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, -2, -1…\n$ arr_time       <int> 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 849,…\n$ sched_arr_time <int> 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 851,…\n$ arr_delay      <dbl> 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3, 7, -1…\n$ carrier        <chr> \"UA\", \"UA\", \"AA\", \"B6\", \"DL\", \"UA\", \"B6\", \"EV\", \"B6\", \"…\n$ flight         <int> 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301, 4…\n$ tailnum        <chr> \"N14228\", \"N24211\", \"N619AA\", \"N804JB\", \"N668DN\", \"N394…\n$ origin         <chr> \"EWR\", \"LGA\", \"JFK\", \"JFK\", \"LGA\", \"EWR\", \"EWR\", \"LGA\",…\n$ dest           <chr> \"IAH\", \"IAH\", \"MIA\", \"BQN\", \"ATL\", \"ORD\", \"FLL\", \"IAD\",…\n$ air_time       <dbl> 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149, 1…\n$ distance       <dbl> 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 733, …\n$ hour           <dbl> 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, 6…\n$ minute         <dbl> 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59, 0…\n$ time_hour      <dttm> 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-01-01 0…\n```\n:::\n:::\n",
    "supporting": [
      "chapter-12_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}